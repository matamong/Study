# **[HuggingFace ğŸ¤—](https://huggingface.co/)**
NLP Transformer ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µí•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤. ëª¨ë¸ì„ êµ¬ì„±í•˜ê³  í•™ìŠµí•˜ê³  í‰ê°€í•  ë•Œ ì“¸ ìˆ˜ ìˆìŒ. ë°ì´í„°ì…‹ë„ ë§ìŒ. í˜ì´ìŠ¤ë¶, ì•„ë§ˆì¡´, êµ¬ê¸€ê°™ì€ íšŒì‚¬ë“¤ë„ ì‚¬ìš© ì¤‘.

<br><br>

# **NLP Metrics**

<br>

## **Bleu Score**
NLP metric ì¤‘ì— ìœ ëª…í•˜ë‹¤. ë‹¨ì ë„ ë§ê³  ì™„ë²½í•˜ì§„ ì•Šì•„ë„ ê³„ì‚°ì´ ê°„ë‹¨í•˜ê³  ì¥ì ì´ ìˆë‹¤. ì•„ì§ê¹Œì§€ ì˜ ì“°ëŠ” ë“¯. <br>
predict ë¬¸ì¥ì´ ì¸ê°„ì´ ë§Œë“  target ë¬¸ì¥ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ì¢‹ë‹¤ëŠ” ìƒê°ì— ê·¼ê±°í•œë‹¤.
- 0~1 ê°’ì„ ê°€ì§€ê³  ìˆë‹¤.
    - ì¸ê°„ë“¤ì´ ë˜‘ê°™ì€ ë¬¸ì¥ì„ ë§Œë“¤ ìˆœ ì—†ìœ¼ë‹ˆê¹Œ  0.6 ~ 0.7 ì •ë„ë©´ ì˜ ë‚˜ì˜¨ ê²ƒ.
    - ë§Œì•½ 1ì— ê°€ê¹Œìš´ ìˆ˜ì¹˜ê°€ ë‚˜ì˜¨ë‹¤ë©´ overfittingì´ ë˜ì—ˆì„ ìˆ˜ ìˆìŒ.

<br>

ë” ì•Œì•„ë³´ê¸° ì „ì—, `n-gram`ê³¼ `Clipped Precision`ì„ ì•Œì•„ë³´ê³  ì˜¤ì.

<br>

### **n-gram**
ì¼ë°˜ í…ìŠ¤íŠ¸ ì²˜ë¦¬ì—ì„œ ìì£¼ ì‚¬ìš©ë¨. <br>
ex) The ball is blue
- 1-gram (unigram): `'The'`, `'ball'`, `'is'`, `'blue'`
- 2-gram (bigram): `'The ball'`, `'ball is'`, `'is blue'`
- 3-gram (trigram): `'The ball is'`, `'ball is blue'`
- 4-gram: `'The ball is blue'`

n-gramì€ ì°¨ë¡€ëŒ€ë¡œ í•´ì•¼í•œë‹¤.

<br><br>

### **Precision**
ì´ ë©”íŠ¸ë¦­ì€ target ë¬¸ì¥ì—ì„œë„ ë°œìƒí•˜ëŠ” ì˜ˆì¸¡ ë¬¸ì¥ì˜ ë‹¨ì–´ ìˆ˜ë¥¼ ì¸¡ì •í•œë‹¤.
- target : He eats an apple
- ì˜ˆì¸¡ ë¬¸ì¥ : He ate an apple

ìœ„ì™€ ê°™ì´ targetê³¼ ì˜ˆì¸¡ ë¬¸ì¥ì´ ìˆë‹¤ë©´ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì‹ì„ ì´ìš©í•˜ì—¬ Precisionì„ ê³„ì‚°í•œë‹¤. <br>

```
Precision = ì•Œë§ê²Œ ì˜ˆì¸¡í•œ ë‹¨ì–´ ìˆ˜ / ì´ ì˜ˆì¸¡ ë‹¨ì–´ ìˆ˜
```
<br>

ì´ ì‹ì„ ì´ìš©í•˜ì—¬ ìœ„ì˜ ì˜ˆì œë¬¸ì¥ì„ ê³„ì‚°í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ê³„ì‚°ëœë‹¤.
```
Precision = 3 / 4
```
í•˜ì§€ë§Œ ì´ëŸ° ì‹ìœ¼ë¡œ Precisionì„ ì´ìš©í•˜ëŠ” ê²ƒì€ ì¶©ë¶„í•˜ì§€ì•Šë‹¤. ì•„ì§ ë‘ê°€ì§€ì˜ ê²½ìš°ë¥¼ ë‹¤ë£¨ì–´ì•¼í•˜ê¸°ë•Œë¬¸ì´ë‹¤.

<br>
ë§Œì•½, ë‹¤ìŒê³¼ ê°™ì€ targetë¬¸ì¥ê³¼ ì˜ˆì¸¡ ë¬¸ì¥ì„ Precisionìœ¼ë¡œ ê³„ì‚°í•˜ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

- target ë¬¸ì¥ : He eats an apple
- ì˜ˆì¸¡ ë¬¸ì¥ : He He He

```
Precision = 3 / 3 = 1
```

ì™„ë²½í•˜ê²Œ 1ì´ ë‚˜ì™€ë²„ë¦°ë‹¤.

<br><br>


#### **Clipped Precision**
Clipped Precisionì€ ì•ì—ì„œ ë§ í•œ Precisionì˜ ë‹¨ì ì„ ë³´ì™„í•˜ê¸° ìœ„í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ ê³„ì‚°í•œë‹¤.

- ì˜ˆì¸¡ ë¬¸ì¥ì˜ ê° ë‹¨ì–´ë¥¼ ëª¨ë“  target ë¬¸ì¥ê³¼ ë¹„êµí•˜ê³  ì¼ì¹˜í•˜ëŠ”ê²Œ ìˆìœ¼ë©´ ë§ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼í•œë‹¤.
- ë§ëŠ” ë‹¨ì–´ëŠ” targetë¬¸ì¥ì— ì•ˆì— ìˆëŠ” í•´ë‹¹ ë‹¨ì–´ì˜ ìˆ˜ê¹Œì§€ë¡œë§Œ ì œí•œí•´ë²„ë¦°ë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ìœ„ì—ì„œ ë´¤ë˜ ì¤‘ë³µë¬¸ì œëŠ” í•´ê²°ëœë‹¤.

<br>

ì•„ë˜ì™€ ê°™ì€ ë¬¸ì¥ì´ ìˆë‹¤ê³  í•´ë³´ì.
- target ë¬¸ì¥ 1: He eats a sweet apple
- target ë¬¸ì¥ 2: He is eating a tasty apple
- ì˜ˆì¸¡ ë¬¸ì¥: He He He eats tasty fruit

<br>
<br>

|  Word 	| Matching Sentence 	| Matched Predicted Count 	| Clipped Count 	|
|:-----:	|:-----------------:	|:-----------------------:	|:-------------:	|
|   He  	|        Both       	|            3            	|       1       	|
|  eats 	|      Target1      	|            1            	|       1       	|
| tasty 	|      Target2      	|            1            	|       1       	|
| fruit 	|        None       	|            0            	|       0       	|
| total 	|                   	|            5            	|       3       	|

- `'He'` ëŠ” ê° target ë¬¸ì¥ì—ì„œ í•œë²ˆì”©ë§Œ ìˆë‹¤.
- ì˜ˆì¸¡ ë¬¸ì¥ì—ì„œ `'He'`ê°€ ì„¸ë²ˆ ë‚˜ì˜¨ë‹¤ê³  í•´ë„ target ë¬¸ì¥ì˜ ìµœëŒ€ ì¶œí˜„ìˆ˜ì¸ í•œ ë²ˆìœ¼ë¡œ í´ë¦½í•œë‹¤(`cliped`).

<br><br>

```
Clipped Precision = í´ë¦¬í•‘ ëœ ì•Œë§ì€ ì˜ˆì¸¡ ë‹¨ì–´ ìˆ˜ / ì´ ì˜ˆì¸¡ ë‹¨ì–´ ìˆ˜
```
```
Clipped Precision = 3 / 6
```

<br><br>

### **Bleu Scoreê°€ ê³„ì‚°ë˜ëŠ” ë²•**
ê°„ë‹¨í•œ ì˜ˆë¥¼ ìœ„í•´ target ë¬¸ì¥ í•˜ë‚˜ë§Œ ì·¨í•´ì„œ ë¬¸ì¥ì„ ì˜ˆì¸¡í•˜ëŠ” NLP ëª¨ë¸ì´ ìˆë‹¤ê³  í•´ë³´ì.
- target ë¬¸ì¥ : The guard arrived late because it was raining
- ì˜ˆì¸¡ ë¬¸ì¥ : The guard arrived late because of the rain

ì²«ë²ˆì§¸ ë‹¨ê³„ëŠ” 1-gramì—ì„œ 4-gramê¹Œì§€ì˜ Precision Scoreë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì´ë‹¤.

<br>

#### **Precision 1-gram(Cliped)**

<br>

```
Precision 1-gram = 1-gramsë¡œ ì˜¬ë°”ë¥´ê²Œ ì˜ˆì¸¡í•œ ìˆ˜ / 1-gramsì˜ ì´ ì˜ˆì¸¡ ìˆ˜
```
- target ë¬¸ì¥ : `The` `guard` `arrived` `late` `because` it was raining
- ì˜ˆì¸¡ ë¬¸ì¥ : `The` `guard` `arrived` `late` `because` of the rain

<br>

```
Presisoin 1-gram(p1) = 5 / 8
```
<br><br>


#### **Precision 2-gram(Cliped)**

<br>

```
Precision 2-gram = 2-gramsë¡œ ì˜¬ë°”ë¥´ê²Œ ì˜ˆì¸¡í•œ ìˆ˜ / 2-gramsì˜ ì´ ì˜ˆì¸¡ ìˆ˜
```
- target ë¬¸ì¥ : `The guard` `arrived late` because it was raining
- ì˜ˆì¸¡ ë¬¸ì¥ : `The guard` `arrived late` because of the rain

ìœ„ì™€ ê°™ì´ ì¹´ìš´íŠ¸ë„ ë˜ê³ 

- target ë¬¸ì¥ : The `guard arrived` `late because` it was raining
- ì˜ˆì¸¡ ë¬¸ì¥ : The `guard arrived` `late because` of the rain

ìœ„ì™€ ê°™ì´ ì¹´ìš´íŠ¸í•  ìˆ˜ ìˆë‹¤.

<br>

```
Presisoin 2-gram(p2) = 4 / 7
```
<br>

#### **Precision n-gram(Cliped)**
ìœ„ì˜ ë°©ì‹ìœ¼ë¡œ 1-gramì—ì„œ 4-gramê¹Œì§€ ì­‰ ê³„ì‚°í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê°’ì´ ë‚˜ì˜¨ë‹¤.
- 1-grams : 5 / 8 
- 2-grams : 4 / 7
- 3-grams : 3 / 6
- 4-grams : 2 / 5


<br><br>

#### **Geometric Average Precision Scores**
ê·¸ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì•„ë˜ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ì´ Precision Scoreë¥¼ í•©ì³ì¤€ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ *`N = 4`* , *`w_n = N / 4`*

<br>

![https://towardsdatascience.com/foundations-of-nlp-explained-bleu-score-and-wer-metrics-1a5ba06d812b](https://github.com/matamatamong/img/blob/main/Visualizations/Geometric%20Average%20Precision%20Scores.png?raw=true)

<br><br>

#### **Brevity Penalty**
ì„¸ë²ˆì§¸ ë‹¨ê³„ì—ì„œëŠ” `Brevity Penalty` ë¥¼ ê³„ì‚°í•œë‹¤. ìœ„ì˜ ë‹¨ê³„ë¡œ ê³„ì‚°ì„ í•œë‹¤ë©´ ë‹¨ì–´ê°€ ì ì„ ìˆ˜ë¡ ì •í™•ë„ê°€ ë†’ì•„ì§€ê¸° ë•Œë¬¸ì— ëª¨ë¸ì€ ì •í™•ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ ìµœëŒ€í•œ ì ì€ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ê²Œ ë˜ì–´ë²„ë¦´ ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ ë§‰ê¸° ìœ„í•´ì„œ ì´ë¦„ ê·¸ëŒ€ë¡œ ì§§ì€ ë¬¸ì¥ì— íŒ¨ë„í‹°ë¥¼ ë¶€ì—¬í•œë‹¤.

<br>

![https://towardsdatascience.com/foundations-of-nlp-explained-bleu-score-and-wer-metrics-1a5ba06d812b](https://github.com/matamatamong/img/blob/main/Visualizations/Brevity%20Penalty.png?raw=true)

- c ëŠ” ì˜ˆìƒ ê¸¸ì´ = ì˜ˆìƒ ë¬¸ì¥ì˜ ë‹¨ì–´ ìˆ˜
- r ì€ target ê¸¸ì´ = target ë¬¸ì¥ì˜ ë‹¨ì–´ ìˆ˜

ì´ë ‡ê²Œ í•´ì£¼ë©´ ì˜ˆìƒ ë¬¸ì¥ì´ targetë³´ë‹¤ ê¸¸ì–´ë„ `Brevity Penalty` ê°€ 1ë³´ë‹¤ í´ ìˆ˜ ê°€ ì—†ìœ¼ë©° ì˜ˆìƒ ë¬¸ì¥ì˜ ê¸¸ì´ê°€ ì§§ìœ¼ë©´ ê°’ë„ ì‘ì•„ì§„ë‹¤.

<br>

ì´ê²ƒì„ ìœ„ì˜ ì˜ˆì œì— ì ìš©í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.
```
c = 8
r = 8
Brevity Penalty = 1
```

<br><br>

#### **Bleu Score**
ë§ˆì§€ë§‰ìœ¼ë¡œ Bleu Scoreë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì•ì„œ êµ¬í•´ë’€ë˜  **Geometric Average Precision Scores** ê°’ê³¼ **Brevity Penalty** ë¥¼ ê³±í•œë‹¤.

```
Bleu(N) = Brevity Penalty * Geometric Average Precision Scores (N)
```

<br>

ë³´í†µ Nê°’ì„ ë‹¤ë¥´ê²Œ í•´ì„œ Bleu scoreë¥¼ êµ¬í•˜ëŠ”ë° ë³´í†µ *`n = 4`* ë¥¼ ì‚¬ìš©í•œë‹¤. <br>
- BLEU-1ì€ `unigram Precision score`ë¥¼ ì‚¬ìš©
- BLEU-2ëŠ” `geometric average`ì˜ `unigram` ê³¼ `bigram-precision` ì„ ì‚¬ìš©
- BLEU-3ì€ `geometric average`ì˜ `unigram` ê³¼ `bigram-precision`, `trigram` ì„ ì‚¬ìš©
- ... ë“±ë“±

<br><br>

ë˜í•œ ì•„ë˜ì˜ ê³µì‹ë„ ë‹¬ë¼ë³´ì´ì§€ë§Œ ê²°êµ­ì—ëŠ” ìš°ë¦¬ê°€ í–ˆë˜ ë˜‘ê°™ì€ ì‹ì´ë‹¤.

![https://towardsdatascience.com/foundations-of-nlp-explained-bleu-score-and-wer-metrics-1a5ba06d812b ](https://github.com/matamatamong/img/blob/main/Visualizations/log%20bleu.png?raw=true)

<br><br><br>

## **CharacterErrorRate (CER)**
- Word Error Rate (WER) ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ Character ë‹¨ìœ„ë¡œ ì‘ë™ë¨.


<br><br><br>

* * *
https://towardsdatascience.com/foundations-of-nlp-explained-bleu-score-and-wer-metrics-1a5ba06d812b <br>
